# Set execution policy to allow running scripts
Set-ExecutionPolicy RemoteSigned -Scope CurrentUser -Force

# Download Python installer to the script execution directory
Write-Host "Downloading Python installer..."
Invoke-WebRequest -Uri "https://www.python.org/ftp/python/3.9.1/python-3.9.1-amd64.exe" -OutFile "python-installer.exe"

# Install Python
Write-Host "Installing Python..."
& .\python-installer.exe /quiet TargetDir="C:\Program Files\Python39"

# Remove the Python installer
Remove-Item -Path ".\python-installer.exe"

# Download get-pip.py to the script execution directory
Write-Host "Downloading pip installer..."
Invoke-WebRequest -Uri "https://bootstrap.pypa.io/get-pip.py" -OutFile "get-pip.py"

# Install pip
Write-Host "Installing pip..."
& "C:\Program Files\Python39\python.exe" .\get-pip.py

# Remove get-pip.py
Remove-Item -Path ".\get-pip.py"

# Install required Python packages
Write-Host "Installing required packages..."
& "C:\Program Files\Python39\Scripts\pip.exe" install -U pip
& "C:\Program Files\Python39\Scripts\pip.exe" install requests tqdm python-docx openpyxl

Write-Host "Installation completed."
